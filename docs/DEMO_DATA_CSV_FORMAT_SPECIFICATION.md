# デモデータCSVフォーマット仕様書

## 概要

このドキュメントでは、デモデータとして使用するCSVファイルのフォーマット仕様を定義します。
この仕様に従ってCSVファイルを作成すれば、システムに直接統合できます。

---

## 1. 取引データ（Trades）

### ファイル名
- `A.csv`, `B.csv`, `C.csv` など
- 配置場所: `/public/demo/`

### CSVフォーマット

**ヘッダー行（1行目）**:
```csv
Ticket,Item,Type,Size,Open Time,Open Price,Close Time,Close Price,S/L,T/P,Commission,Swap,Profit,Setup,Comment
```

**データ行の例**:
```csv
500000001,EURUSD,buy,0.1,2024.11.01 09:30:00,1.08500,2024.11.01 15:45:00,1.08650,1.08300,1.08800,-7,0,1450,Trend,順張りエントリー成功
500000002,USDJPY,sell,0.2,2024.11.01 13:20:00,149.850,2024.11.01 17:30:00,149.650,0,0,-7,0,2800,Range,レンジ上限からの戻り
500000003,GBPJPY,buy,0.15,2024.11.01 15:00:00,188.500,2024.11.01 15:30:00,188.650,0,0,-7,0,1950,Breakout,ブレイクアウト成功
```

### カラム定義

| カラム名 | データ型 | 必須 | 説明 | 例 |
|---------|---------|------|------|-----|
| Ticket | text | ✅ | 取引番号（一意） | 500000001 |
| Item | text | ✅ | 通貨ペア | EURUSD, USDJPY, GBPJPY |
| Type | text | ✅ | 取引種別 | buy, sell, balance, deposit |
| Size | numeric | ✅ | ロットサイズ | 0.1, 0.5, 1.0 |
| Open Time | timestamp | ✅ | エントリー時刻 | 2024.11.01 09:30:00 |
| Open Price | numeric | ✅ | エントリー価格 | 1.08500 |
| Close Time | timestamp | ✅ | 決済時刻 | 2024.11.01 15:45:00 |
| Close Price | numeric | ✅ | 決済価格 | 1.08650 |
| S/L | numeric | ⚪ | ストップロス | 1.08300 (0 or 0.0 で未設定) |
| T/P | numeric | ⚪ | テイクプロフィット | 1.08800 (0 or 0.0 で未設定) |
| Commission | numeric | ✅ | 手数料（円） | -7 |
| Swap | numeric | ✅ | スワップ（円） | 0, -150, 200 |
| Profit | numeric | ✅ | 損益（円） | 1450, -2300 |
| Setup | text | ⚪ | トレード戦略/セットアップ | Trend, Breakout, Reversal, Range, Scalp |
| Comment | text | ⚪ | コメント | 順張りエントリー成功 |

### Setup（戦略タイプ）の推奨値

| Setup値 | 日本語 | 説明 |
|---------|-------|------|
| Trend | トレンドフォロー | 明確なトレンド方向への順張り |
| Breakout | ブレイクアウト | レジスタンス/サポートのブレイク |
| Reversal | リバーサル | トレンド転換を狙った逆張り |
| Range | レンジトレード | レンジ内での逆張り |
| Scalp | スキャルピング | 短時間の小幅な値動きを狙う |

**注意**: Setup は空文字列でも可。ただし、戦略分析機能を最大限活用するため、できるだけ設定することを推奨します。

### 推奨される通貨ペア

| 通貨ペア | 説明 |
|---------|------|
| EURUSD | ユーロ/米ドル |
| USDJPY | 米ドル/円 |
| GBPJPY | ポンド/円 |
| GBPUSD | ポンド/米ドル |
| AUDUSD | 豪ドル/米ドル |
| USDCAD | 米ドル/カナダドル |
| EURJPY | ユーロ/円 |
| AUDJPY | 豪ドル/円 |

### 注意事項

1. **Ticket番号**: 同じCSVファイル内で一意である必要があります
2. **Type**: `balance`と`deposit`は入金・残高調整用の特殊な取引タイプです
3. **Setup**: システムが戦略分析に使用します。必須ではありませんが設定を推奨
4. **日時フォーマット**: `YYYY.MM.DD HH:MM:SS` 形式を使用
5. **数値**: 小数点は `.` を使用（カンマ区切りは不可）
6. **文字エンコーディング**: UTF-8

---

## 2. 取引ノート（Trade Notes）

### ファイル名
- `A_trade_notes.csv`, `B_trade_notes.csv`, `C_trade_notes.csv` など
- 配置場所: `/public/demo/`

### CSVフォーマット

**ヘッダー行**:
```csv
ticket,entry_emotion,entry_basis,tech_set,market_set,fund_set,fund_note,exit_triggers,exit_emotion,note_right,note_wrong,note_next,note_free,tags,ai_advice
```

**データ行の例**:
```csv
500000001,冷静,["トレンド継続","サポート反発"],["MA交差","RSI30以下"],["上昇トレンド","ボラティリティ高"],["雇用統計良好"],雇用統計後の上昇継続を狙った,["利益目標達成"],満足,ルール通りのエントリーができた,もう少し早くエントリーできた,次回も同じセットアップを狙う,初動を逃さないよう監視を強化,["順張り","デイトレード"],トレンドフォローの好例です
500000002,やや焦り,["レンジ上限"],["ボリンジャー上限タッチ"],["レンジ相場"],[],,["損切り"],反省,レンジ環境を正しく認識できた,ロットが大きすぎた,次回はロットを0.1に抑える,感情的にならないよう注意,["逆張り","スキャルピング"],ロット管理に注意
```

### カラム定義

| カラム名 | データ型 | 必須 | 説明 | 例 |
|---------|---------|------|------|-----|
| ticket | text | ✅ | 取引番号（Trades CSVと対応） | 500000001 |
| entry_emotion | text | ⚪ | エントリー時の感情 | 冷静, 焦り, 自信あり |
| entry_basis | JSON array | ⚪ | エントリー根拠（配列） | ["トレンド継続","サポート反発"] |
| tech_set | JSON array | ⚪ | テクニカル条件（配列） | ["MA交差","RSI30以下"] |
| market_set | JSON array | ⚪ | マーケット環境（配列） | ["上昇トレンド","ボラティリティ高"] |
| fund_set | JSON array | ⚪ | ファンダメンタルズ（配列） | ["雇用統計良好"] |
| fund_note | text | ⚪ | ファンダメンタルズメモ | 雇用統計後の上昇継続を狙った |
| exit_triggers | JSON array | ⚪ | 決済のきっかけ（配列） | ["利益目標達成","損切り"] |
| exit_emotion | text | ⚪ | 決済時の感情 | 満足, 後悔, 焦り |
| note_right | text | ⚪ | うまくいった点 | ルール通りのエントリーができた |
| note_wrong | text | ⚪ | 改善点 | もう少し早くエントリーできた |
| note_next | text | ⚪ | 次回の約束 | 次回も同じセットアップを狙う |
| note_free | text | ⚪ | 自由メモ | 初動を逃さないよう監視を強化 |
| tags | JSON array | ⚪ | タグ（配列） | ["順張り","デイトレード"] |
| ai_advice | text | ⚪ | AIアドバイス | トレンドフォローの好例です |

### 推奨される感情の表現

**エントリー時（entry_emotion）**:
- 冷静、自信あり、確信、期待、迷い、焦り、不安、恐怖

**決済時（exit_emotion）**:
- 満足、達成感、安堵、後悔、悔しい、焦り、冷静、反省

### テクニカル条件の例（tech_set）

- MA交差、MA上抜け、MA下抜け
- RSI30以下、RSI70以上、RSIダイバージェンス
- ボリンジャー上限タッチ、ボリンジャー下限タッチ、ボリンジャー中央回帰
- MACD買いシグナル、MACD売りシグナル
- サポートライン反発、レジスタンスライン反発
- 高値更新、安値更新
- ゴールデンクロス、デッドクロス
- フィボナッチ38.2%、フィボナッチ61.8%

### マーケット環境の例（market_set）

- 上昇トレンド、下降トレンド、レンジ相場
- ボラティリティ高、ボラティリティ低
- 流動性高、流動性低
- 東京時間、ロンドン時間、ニューヨーク時間
- 週初、週末
- 月初、月末
- トレンド初動、トレンド終盤

### ファンダメンタルズの例（fund_set）

- 雇用統計良好、雇用統計悪化
- 政策金利据え置き、利上げ、利下げ
- GDP上方修正、GDP下方修正
- 地政学リスク高、地政学リスク低
- 要人発言タカ派、要人発言ハト派
- リスクオン、リスクオフ

### 決済トリガーの例（exit_triggers）

- 利益目標達成、損切り、トレーリングストップ
- 時間切れ、ロールオーバー前
- 反転シグナル検出
- ボラティリティ低下
- 指標発表前
- 想定と違う動き

### タグの推奨値

**トレードスタイル**:
- 順張り、逆張り、スキャルピング、デイトレード、スイングトレード

**結果**:
- 勝ち、負け、建値撤退、薄利決済、損切り

**品質**:
- 完璧、良好、普通、反省、失敗

**環境**:
- トレンド、レンジ、ブレイクアウト、高ボラ、低ボラ

**時間帯**:
- 東京時間、ロンドン時間、NY時間、オーバーナイト

### JSON配列の書き方

```csv
["要素1","要素2","要素3"]
```

- ダブルクォートで囲む
- 要素はカンマで区切る
- 空の配列: `[]`
- CSV内でダブルクォートをエスケープする場合は `""` を使用

### 注意事項

1. **ticket**: Trades CSVの`Ticket`カラムと完全一致する必要があります
2. **すべてのカラムは省略可能**: 空の場合は空文字列 `""` を設定
3. **JSON配列**: 正しいJSON形式で記述（不正な形式はエラーになります）
4. **改行**: CSVフィールド内の改行は `\n` でエスケープ

---

## 3. 日次ノート（Daily Notes）

### ファイル名
- `A_daily_notes.csv`, `B_daily_notes.csv`, `C_daily_notes.csv` など
- 配置場所: `/public/demo/`

### CSVフォーマット

**ヘッダー行**:
```csv
date_key,title,good,improve,next_promise,free
```

**データ行の例**:
```csv
2024-11-01,堅実なトレード,ルール遵守ができた。損切りも迷わず実行,エントリーが少し遅れた,明日はもっと早く動く,今日の相場は上昇トレンドが明確だった
2024-11-02,反省の多い日,ロット管理は良好,感情的になって無駄なトレードをした,冷静さを保つ。トレード前に深呼吸,レンジ相場でのトレードは慎重に
```

### カラム定義

| カラム名 | データ型 | 必須 | 説明 | 例 |
|---------|---------|------|------|-----|
| date_key | text | ✅ | 日付キー（YYYY-MM-DD） | 2024-11-01 |
| title | text | ⚪ | タイトル | 堅実なトレード |
| good | text | ⚪ | うまくいった点 | ルール遵守ができた |
| improve | text | ⚪ | 改善点 | エントリーが少し遅れた |
| next_promise | text | ⚪ | 次回の約束 | 明日はもっと早く動く |
| free | text | ⚪ | 自由メモ | 今日の相場は上昇トレンドが明確 |

### 注意事項

1. **date_key**: `YYYY-MM-DD` 形式で統一
2. **date_keyの範囲**: Trades CSVに含まれる取引日付と対応させる
3. **取引がない日**: 日記のみ作成することも可能
4. **改行**: フィールド内の改行は `\n` でエスケープ、またはダブルクォートで囲む

---

## 4. 自由メモ（Free Memos）

### ファイル名
- `A_free_memos.csv`, `B_free_memos.csv`, `C_free_memos.csv` など
- 配置場所: `/public/demo/`

### CSVフォーマット

**ヘッダー行**:
```csv
id,title,content,date_key,tags
```

**データ行の例**:
```csv
memo-001,重要な気づき,トレンドフォローが自分に合っている。逆張りは避けるべき,2024-11-01,["戦略","気づき"]
memo-002,リスク管理メモ,1日の最大損失は資金の2%まで。これを厳守する,2024-11-02,["リスク管理","ルール"]
```

### カラム定義

| カラム名 | データ型 | 必須 | 説明 | 例 |
|---------|---------|------|------|-----|
| id | text | ✅ | メモID（一意） | memo-001, memo-002 |
| title | text | ✅ | タイトル | 重要な気づき |
| content | text | ⚪ | メモ内容 | トレンドフォローが自分に合っている |
| date_key | text | ✅ | 作成日（YYYY-MM-DD） | 2024-11-01 |
| tags | JSON array | ⚪ | タグ（配列） | ["戦略","気づき"] |

### 注意事項

1. **id**: CSVファイル内で一意である必要があります（`memo-001`, `memo-002`など）
2. **content**: 長文可能（ダブルクォートで囲む）
3. **tags**: JSON配列形式で記述

---

## 5. ノート間リンク（Note Links）

### ファイル名
- `A_note_links.csv`, `B_note_links.csv`, `C_note_links.csv` など
- 配置場所: `/public/demo/`

### CSVフォーマット

**ヘッダー行**:
```csv
source_type,source_id,target_type,target_id
```

**データ行の例**:
```csv
trade,500000001,daily,2024-11-01
trade,500000002,daily,2024-11-01
daily,2024-11-01,free,memo-001
free,memo-002,trade,500000003
```

### カラム定義

| カラム名 | データ型 | 必須 | 説明 | 値の種類 |
|---------|---------|------|------|---------|
| source_type | text | ✅ | リンク元タイプ | `trade`, `daily`, `free` |
| source_id | text | ✅ | リンク元ID | ticket番号, date_key, メモID |
| target_type | text | ✅ | リンク先タイプ | `trade`, `daily`, `free` |
| target_id | text | ✅ | リンク先ID | ticket番号, date_key, メモID |

### リンクの例

- 取引 → 日次ノート: `trade,500000001,daily,2024-11-01`
- 日次ノート → 自由メモ: `daily,2024-11-01,free,memo-001`
- 取引 → 取引: `trade,500000001,trade,500000002`（関連する取引同士をリンク）

### 注意事項

1. **type**: `trade`, `daily`, `free` のいずれか
2. **ID**: 対応するCSVファイルに存在するIDを指定
3. **双方向リンク**: 必要に応じて両方向のリンクを作成

---

## 6. データの整合性チェックリスト

CSVファイルを作成したら、以下をチェックしてください:

### ✅ 基本チェック
- [ ] すべてのファイルがUTF-8エンコーディング
- [ ] ヘッダー行が正しい順序・スペルで記述されている
- [ ] カラム数が全行で一致している
- [ ] 必須カラムに空白がない

### ✅ データの整合性
- [ ] Trades CSVの`Ticket`が一意
- [ ] Trade Notes CSVの`ticket`がTrades CSVに存在
- [ ] Daily Notes CSVの`date_key`が`YYYY-MM-DD`形式
- [ ] Free Memos CSVの`id`が一意
- [ ] Note Links CSVの`source_id`と`target_id`が対応するCSVに存在

### ✅ JSON形式
- [ ] JSON配列が正しい形式（`["要素1","要素2"]`）
- [ ] 空の配列は`[]`と記述
- [ ] ダブルクォートのエスケープが正しい

### ✅ 日付・数値
- [ ] 日時が`YYYY.MM.DD HH:MM:SS`形式（Trades CSV）
- [ ] 日付が`YYYY-MM-DD`形式（Daily Notes, Free Memos）
- [ ] 数値に不正な文字が含まれていない

---

## 7. サンプルデータセット

### 最小構成の例

**A.csv** (最低限の取引データ):
```csv
Ticket,Item,Type,Size,Open Time,Open Price,Close Time,Close Price,S/L,T/P,Commission,Swap,Profit,Setup,Comment
500000001,EURUSD,buy,0.1,2024.11.01 09:30:00,1.08500,2024.11.01 15:45:00,1.08650,0,0,-7,0,1450,Trend,トレンドフォロー成功
500000002,USDJPY,sell,0.2,2024.11.01 13:20:00,149.850,2024.11.01 17:30:00,149.650,0,0,-7,0,2800,Range,レンジ上限反発
```

**A_trade_notes.csv** (取引1件のみにノート):
```csv
ticket,entry_emotion,entry_basis,tech_set,market_set,fund_set,fund_note,exit_triggers,exit_emotion,note_right,note_wrong,note_next,note_free,tags,ai_advice
500000001,冷静,["トレンド継続"],["MA交差"],[],[],,"["利益目標達成"]",満足,ルール通り,なし,継続,良いトレード,["順張り"],好例
```

**A_daily_notes.csv** (1日分のノート):
```csv
date_key,title,good,improve,next_promise,free
2024-11-01,良い日,ルール遵守,特になし,継続,上昇トレンド
```

---

## 8. データセット識別子について

システムは複数のデモデータセット（A, B, C）を管理できます。

### データセット構成

| データセット | 用途 | 例 |
|------------|------|-----|
| A | メインデモデータ | 標準的なトレーダーの1ヶ月間の記録 |
| B | 比較用データ | 異なるトレードスタイルのデータ |
| C | テスト用データ | 特定のシナリオをテストするデータ |

各データセットは独立しており、ユーザーが切り替えて閲覧できます。

---

## 9. AI生成用プロンプト

他のAIにデモデータを生成してもらう場合、以下のプロンプトを使用してください:

```
# FXトレード日記デモデータ生成依頼

以下の仕様に従って、FXトレード日記用のリアルなデモデータセットを生成してください。

## 生成するファイル
1. A.csv（取引データ: 100-200件）
2. A_trade_notes.csv（取引ノート: 取引の30-50%程度にノートを付ける）
3. A_daily_notes.csv（日次ノート: 取引がある日付の50-70%程度）
4. A_free_memos.csv（自由メモ: 5-10件、重要な気づきや戦略メモ）
5. A_note_links.csv（ノート間リンク: 10-20件、関連する情報を結びつける）

## データの要件

### 基本設定
- **期間**: 2024年11月1日〜2024年11月30日（1ヶ月分）
- **トレードスタイル**: デイトレード60% / スイングトレード40%
- **通貨ペア**: EURUSD, USDJPY, GBPJPY, AUDUSD, USDCAD, EURJPY（主要6ペア）
- **勝率**: 55-65%（リアルな範囲）
- **損益**: プラス収支（月間 +100,000円 〜 +300,000円程度）
- **取引頻度**: 平日1日あたり3-6件
- **ロットサイズ**: 0.1〜0.5ロット（資金管理を意識）

### 戦略構成（Setup列）
- Trend（トレンドフォロー）: 40%
- Breakout（ブレイクアウト）: 25%
- Range（レンジトレード）: 20%
- Reversal（リバーサル）: 10%
- Scalp（スキャルピング）: 5%

### リアリティの追求

**取引の質**:
- 損切りも含めた現実的なトレード（完璧すぎない）
- 連勝・連敗の波がある（3連勝の後に2連敗など）
- 時々ルール違反のトレードも含める（焦りや感情的なエントリー）
- ストップロス・テイクプロフィットの設定率: 60%程度

**感情の表現**:
- エントリー時: 冷静（60%）、焦り（20%）、自信あり（15%）、迷い（5%）
- 決済時: 満足（40%）、安堵（20%）、後悔（25%）、反省（15%）

**ノートの書き方**:
- 具体的なテクニカル根拠（MA、RSI、ボリンジャーなど）
- マーケット環境の認識（トレンド、ボラティリティなど）
- ファンダメンタルズは20%程度のトレードで言及
- 反省点や改善点を率直に記載
- 次回への具体的な約束

**日次ノート**:
- その日の総括（良かった点・改善点）
- 相場環境の観察
- メンタル面の振り返り
- 週末や週初には週単位の振り返りも

**自由メモ**:
- 重要な戦略の気づき
- リスク管理ルールの確認
- 過去の失敗パターンの分析
- トレード計画や目標設定

### 取引時間の分布
- 東京時間（9:00-15:00）: 30%
- ロンドン時間（15:00-21:00）: 40%
- ニューヨーク時間（21:00-6:00）: 30%

### 価格の現実性
- 2024年11月の実際の相場レンジを参考にする
- EURUSD: 1.05-1.10 程度
- USDJPY: 145-155 程度
- GBPJPY: 185-195 程度
- 各通貨ペアのスプレッド・手数料を考慮

## 重要な注意事項

1. **Setup列を必ず設定**: 戦略分析機能で使用されます
2. **JSON配列は正確に**: `["要素1","要素2"]` の形式を厳守
3. **日付フォーマット**: Trades は `YYYY.MM.DD HH:MM:SS`、その他は `YYYY-MM-DD`
4. **Ticket番号**: 500000001 から順番に採番
5. **整合性**: trade_notes の ticket は trades.csv に存在する ticket のみ
6. **文字エンコーディング**: UTF-8

## フォーマット仕様
（以下、CSVフォーマット仕様書全体を添付）

---

生成後、必ず整合性チェックリストで検証してください。
```

---

## 10. まとめ

### ファイル一覧
```
/public/demo/
├── A.csv                   # 取引データ（必須）
├── A_trade_notes.csv       # 取引ノート（オプション）
├── A_daily_notes.csv       # 日次ノート（オプション）
├── A_free_memos.csv        # 自由メモ（オプション）
├── A_note_links.csv        # ノート間リンク（オプション）
├── B.csv                   # データセットB（オプション）
├── B_trade_notes.csv
├── B_daily_notes.csv
└── ...
```

### 統合手順
1. CSVファイルを仕様に従って作成
2. `/public/demo/`フォルダに配置
3. システムが自動的に読み込み・表示

### 必須項目のクイックリファレンス

**Trades CSV (A.csv)**:
- Ticket, Item, Type, Size, Open Time, Open Price, Close Time, Close Price, Commission, Swap, Profit
- Setup列を追加推奨（Trend, Breakout, Reversal, Range, Scalp）

**Trade Notes CSV (A_trade_notes.csv)**:
- ticket（Trades CSVと対応）
- その他すべて任意（ただし、リッチなデータのため推奨）

**Daily Notes CSV (A_daily_notes.csv)**:
- date_key（YYYY-MM-DD形式）
- その他すべて任意

### よくある質問

**Q: すべてのトレードにノートを付ける必要がありますか？**
A: いいえ。重要なトレードや反省点があるトレードにのみノートを付けてください。30-50%程度で十分です。

**Q: Setup列は必須ですか？**
A: 必須ではありませんが、戦略分析機能を使うために強く推奨します。

**Q: データセットA, B, Cの使い分けは？**
A: Aをメインデータ、B・Cを比較用や異なるシナリオのテストデータとして使用できます。

**Q: JSON配列の中にカンマを含む文字列を入れたい場合は？**
A: `["要素1","カンマ,を含む要素","要素3"]` のように記述できます。

### サポート
- 質問や不明点があれば、このドキュメントを参照してください
- CSV生成後、必ず整合性チェックリストで検証してください
- 不正なJSON形式はインポート時にエラーになります
