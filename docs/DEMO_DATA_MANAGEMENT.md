# ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ç®¡ç†ãƒ«ãƒ¼ãƒ«

**æœ€çµ‚æ›´æ–°**: 2025-11-25
**å¯¾è±¡**: ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’æ›´æ–°ã™ã‚‹å ´åˆã®ãƒ«ãƒ¼ãƒ«

---

## ðŸŽ¯ åŸºæœ¬åŽŸå‰‡

### âœ… çµ¶å¯¾ãƒ«ãƒ¼ãƒ«

**ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã¯CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã§ç®¡ç†ã—ã¾ã™ã€‚ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ä¸€åˆ‡å¤‰æ›´ã—ã¾ã›ã‚“ã€‚**

---

## ðŸ“ ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã®ä¿ç®¡å ´æ‰€

```
/public/demo/
  â”œâ”€â”€ A.csv    (ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆA - ä¿å®ˆçš„ãƒˆãƒ¬ãƒ¼ãƒ€ãƒ¼)
  â”œâ”€â”€ B.csv    (ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆB - ãƒãƒ©ãƒ³ã‚¹åž‹ãƒˆãƒ¬ãƒ¼ãƒ€ãƒ¼)
  â””â”€â”€ C.csv    (ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆC - ç©æ¥µçš„ãƒˆãƒ¬ãƒ¼ãƒ€ãƒ¼)
```

### CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆ

```csv
Ticket,Item,Type,Size,Open Time,Open Price,Close Time,Close Price,S/L,T/P,Commission,Swap,Profit,Comment
100001001,CD-ECS-BWR,balance,0.0,2024.05.27 08:00:00,0.00000,2024.05.27 08:00:00,0.00000,0.00000,0.00000,0,0,1000000,åˆå›žå…¥é‡‘
101000001,GBPJPY,sell,0.5,2024.05.27 00:16:00,186.155,2024.05.29 10:16:00,185.776,186.59,185.417,-12,-38,18950,Reversal
```

---

## ðŸ”„ ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã®æ‰‹é †

### 1. CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æŽ¥ç·¨é›†

```bash
# ã‚¨ãƒ‡ã‚£ã‚¿ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã
vim /public/demo/A.csv
# ã¾ãŸã¯
code /public/demo/A.csv
```

### 2. ãƒ‡ãƒ¼ã‚¿ã®æ¤œè¨¼

ä»¥ä¸‹ã®é …ç›®ã‚’ç¢ºèªï¼š

- [ ] **ãƒ˜ãƒƒãƒ€ãƒ¼è¡ŒãŒæ­£ã—ã„ã‹**
- [ ] **æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆãŒçµ±ä¸€ã•ã‚Œã¦ã„ã‚‹ã‹** (`YYYY.MM.DD HH:mm:ss`)
- [ ] **æ•°å€¤ãŒæ­£ã—ã„ã‹** (ã‚«ãƒ³ãƒžåŒºåˆ‡ã‚Šãªã—)
- [ ] **é€šè²¨ãƒšã‚¢ãŒå®Ÿåœ¨ã™ã‚‹ã‹** (EURUSD, GBPJPY, USDJPY, EURJPY, GBPUSD, AUDUSD)
- [ ] **å–å¼•ã®æ•´åˆæ€§ãŒå–ã‚Œã¦ã„ã‚‹ã‹**
  - Size > 0
  - Open Price > 0
  - Close Price > 0
  - Commission <= 0
  - Profit = (Close Price - Open Price) Ã— Size Ã— Pips - Commission - Swap

### 3. ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®ç¢ºèª

```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•
npm run dev

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹
http://localhost:5173

# ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’é¸æŠžã—ã¦è¡¨ç¤ºã‚’ç¢ºèª
```

---

## âŒ çµ¶å¯¾ã«ã‚„ã£ã¦ã¯ã„ã‘ãªã„ã“ã¨

### 1. ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥

```sql
-- âŒ ç¦æ­¢
INSERT INTO trades (user_id, ticket, item, ..., dataset)
VALUES (NULL, '101000001', 'GBPJPY', ..., 'A');

-- âŒ ç¦æ­¢
INSERT INTO account_transactions (user_id, dataset, ...)
VALUES (NULL, 'A', ...);
```

**ç†ç”±**: ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã‚¹ã‚­ãƒ¼ãƒžå®šç¾©ã®ã¿ã«ä½¿ç”¨ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿æŒ¿å…¥ã¯ç®¡ç†ãŒè¤‡é›‘ã«ãªã‚Šã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚„ãƒ†ã‚¹ãƒˆãŒå›°é›£ã«ãªã‚Šã¾ã™ã€‚

### 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜

```javascript
// âŒ ç¦æ­¢
await supabase
  .from('trades')
  .insert({ dataset: 'A', user_id: null, ... });
```

**ç†ç”±**: ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã¯CSVã‹ã‚‰å‹•çš„ã«èª­ã¿è¾¼ã‚€ã“ã¨ã§ã€ç’°å¢ƒã«ä¾å­˜ã›ãšä¸€è²«æ€§ãŒä¿ãŸã‚Œã¾ã™ã€‚

### 3. RLSãƒãƒªã‚·ãƒ¼ã‚’ç·©ã‚ã‚‹

```sql
-- âŒ ç¦æ­¢
CREATE POLICY "Allow public read for demo data"
  ON trades FOR SELECT
  TO public
  USING (user_id IS NULL OR dataset IN ('A', 'B', 'C'));
```

**ç†ç”±**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ãŒé«˜ã¾ã‚Šã€äºˆæœŸã—ãªã„ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±ã—ã¦ã—ã¾ã„ã¾ã™ã€‚

### 4. datasetã‚«ãƒ©ãƒ ã«'A'/'B'/'C'ã‚’ä¿å­˜

```javascript
// âŒ ç¦æ­¢
await supabase
  .from('trades')
  .insert({ dataset: 'A', ... });
```

**ç†ç”±**: `dataset`ã‚«ãƒ©ãƒ ã¯å°†æ¥å‰Šé™¤äºˆå®šã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã«ã¯`'default'`ã¾ãŸã¯NULLã®ã¿ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

---

## âœ… æŽ¨å¥¨ã•ã‚Œã‚‹æ–¹æ³•

### ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ãƒ•ãƒ­ãƒ¼

```
1. CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
   â†“
2. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜
   â†“
3. ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ï¼‰
   â†“
4. ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
   â†“
5. Gitã«ã‚³ãƒŸãƒƒãƒˆ
```

### ãƒ‡ãƒ¼ã‚¿ã®æ¤œè¨¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```typescript
// /scripts/validate-demo-data.ts ã‚’ä½œæˆ
import { parseCsvText } from '../src/lib/csv';
import fs from 'fs';

const datasetNames = ['A', 'B', 'C'];

for (const name of datasetNames) {
  const content = fs.readFileSync(`./public/demo/${name}.csv`, 'utf-8');
  const trades = parseCsvText(content);

  console.log(`âœ… Dataset ${name}: ${trades.length} trades`);

  // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  trades.forEach((trade, index) => {
    if (!trade.ticket) {
      throw new Error(`Row ${index + 1}: Missing ticket`);
    }
    if (trade.size <= 0) {
      throw new Error(`Row ${index + 1}: Invalid size`);
    }
    // è¿½åŠ ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯...
  });
}

console.log('âœ… All demo data validated successfully');
```

---

## ðŸ” ã‚ˆãã‚ã‚‹å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³

### å¤±æ•—ä¾‹1: ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒ‡ãƒ¢ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆ

```sql
-- âŒ é–“é•ã„
INSERT INTO auth.users (email, encrypted_password, ...)
VALUES ('demo@example.com', crypt('password', gen_salt('bf')), ...);
```

**å•é¡Œç‚¹**:
- ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯é–‹ç™ºãƒ»ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ãƒ»æœ¬ç•ªã§å®Ÿè¡Œã•ã‚Œã‚‹
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ç®¡ç†ãŒè¤‡é›‘
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å‰Šé™¤ãƒ»å†ä½œæˆãŒå›°é›£

**æ­£è§£**:
- ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰æ‰‹å‹•ã§ä½œæˆ
- ã¾ãŸã¯èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ç”¨ã—ã¦ä½œæˆ

### å¤±æ•—ä¾‹2: ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æŒ¿å…¥

```sql
-- âŒ é–“é•ã„
INSERT INTO trades (user_id, dataset, ticket, ...)
VALUES
  (NULL, 'A', '101000001', ...),
  (NULL, 'A', '101000002', ...),
  ...
```

**å•é¡Œç‚¹**:
- ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå·¨å¤§ã«ãªã‚‹
- ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ãŒå›°é›£ï¼ˆæ–°ã—ã„ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¿…è¦ï¼‰
- RLSãƒãƒªã‚·ãƒ¼ãŒè¤‡é›‘ã«ãªã‚‹
- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¨æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ãŒæ··åœ¨

**æ­£è§£**:
- CSVãƒ•ã‚¡ã‚¤ãƒ«ã§ç®¡ç†
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§å‹•çš„ã«èª­ã¿è¾¼ã¿

### å¤±æ•—ä¾‹3: user_id=NULLã®ãƒ‡ãƒ¼ã‚¿ã«ä¾å­˜

```typescript
// âŒ é–“é•ã„
const demoTrades = await supabase
  .from('trades')
  .select('*')
  .is('user_id', null);
```

**å•é¡Œç‚¹**:
- RLSãƒãƒªã‚·ãƒ¼ã§`user_id IS NULL`ã‚’è¨±å¯ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯
- æ„å›³ã—ãªã„ãƒ‡ãƒ¼ã‚¿ãŒæ··å…¥ã™ã‚‹å¯èƒ½æ€§

**æ­£è§£**:
- CSVã‹ã‚‰èª­ã¿è¾¼ã‚€
```typescript
const res = await fetch('/demo/A.csv');
const text = await res.text();
const trades = parseCsvText(text);
```

---

## ðŸ“Š ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. ãƒªã‚¢ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯ãªãƒ‡ãƒ¼ã‚¿

- **å®Ÿéš›ã®å–å¼•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åæ˜ **
- å‹çŽ‡: 50-70%
- ãƒªã‚¹ã‚¯ãƒªãƒ¯ãƒ¼ãƒ‰æ¯”: 1:1.5 ã€œ 1:3
- é©åˆ‡ãªãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³: -10% ã€œ -20%

### 2. ãƒ‡ãƒ¼ã‚¿ã®å¤šæ§˜æ€§

- **è¤‡æ•°ã®é€šè²¨ãƒšã‚¢**: EURUSD, GBPJPY, USDJPYç­‰
- **æ§˜ã€…ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**: Breakout, Reversal, Trend, Rangeç­‰
- **ç•°ãªã‚‹ä¿æœ‰æ™‚é–“**: ã‚¹ã‚­ãƒ£ãƒ«ãƒ”ãƒ³ã‚°ã‹ã‚‰ã‚¹ã‚¤ãƒ³ã‚°ãƒˆãƒ¬ãƒ¼ãƒ‰ã¾ã§
- **æç›Šã®åˆ†æ•£**: å¤§å‹ã¡ã€å°å‹ã¡ã€å°è² ã‘ã€å¤§è² ã‘ã‚’ãƒãƒ©ãƒ³ã‚¹ã‚ˆã

### 3. æ™‚ç³»åˆ—ã®æ•´åˆæ€§

- **é€£ç¶šã—ãŸæ—¥ä»˜**: ãƒ‡ãƒ¼ã‚¿ã«å¤§ããªæœŸé–“ã®ç©ºç™½ã‚’ä½œã‚‰ãªã„
- **å¸‚å ´æ™‚é–“ã‚’è€ƒæ…®**: é€±æœ«ã‚„ä¼‘æ—¥ã‚’é¿ã‘ã‚‹
- **ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³çµ±ä¸€**: ã™ã¹ã¦ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’çµ±ä¸€

### 4. è²¡å‹™ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§

- **æ®‹é«˜ã®æŽ¨ç§»**: å…¥é‡‘ãƒ»å‡ºé‡‘ãƒ»æç›Šã®åˆè¨ˆãŒæ­£ã—ã„
- **ã‚¹ãƒ¯ãƒƒãƒ—ã®è“„ç©**: é•·æœŸä¿æœ‰ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã«ã¯é©åˆ‡ãªã‚¹ãƒ¯ãƒƒãƒ—
- **æ‰‹æ•°æ–™ã®è¨ˆç®—**: ä¸€è²«ã—ãŸæ‰‹æ•°æ–™çŽ‡

---

## ðŸ› ï¸ ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆãƒ„ãƒ¼ãƒ«

æ—¢å­˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ´»ç”¨ï¼š

```bash
# ãƒªã‚¢ãƒ«ãªãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
npx tsx scripts/generate-realistic-demo-data.ts

# CSVã«å¤‰æ›
npx tsx scripts/convert-to-csv.ts

# ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œè¨¼
npx tsx scripts/validate-demo-data.ts
```

---

## ðŸ“ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã™ã‚‹å‰ã«ç¢ºèªï¼š

- [ ] ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¤‰æ›´ã—ã¦ã„ãªã„
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ç›´æŽ¥æŒ¿å…¥ã—ã¦ã„ãªã„
- [ ] CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆãŒæ­£ã—ã„
- [ ] ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ãŒå–ã‚Œã¦ã„ã‚‹
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã§è¡¨ç¤ºã‚’ç¢ºèªã—ãŸ
- [ ] 3ã¤ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆA, B, Cï¼‰ã™ã¹ã¦ã‚’ç¢ºèªã—ãŸ

---

## ðŸš¨ ç·Šæ€¥æ™‚ã®å¯¾å¿œ

### ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ãŒå£Šã‚ŒãŸå ´åˆ

1. **Gitã‹ã‚‰å¾©å…ƒ**
```bash
git checkout HEAD -- public/demo/A.csv
git checkout HEAD -- public/demo/B.csv
git checkout HEAD -- public/demo/C.csv
```

2. **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒ**
```bash
cp backups/demo/A.csv public/demo/
cp backups/demo/B.csv public/demo/
cp backups/demo/C.csv public/demo/
```

3. **å†ç”Ÿæˆ**
```bash
npx tsx scripts/generate-realistic-demo-data.ts
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ãŒæ··å…¥ã—ãŸå ´åˆ

```sql
-- ç·Šæ€¥å‰Šé™¤ï¼ˆæ…Žé‡ã«å®Ÿè¡Œï¼‰
DELETE FROM trades WHERE dataset IN ('A', 'B', 'C');
DELETE FROM account_transactions WHERE dataset IN ('A', 'B', 'C');
DELETE FROM account_summary WHERE dataset IN ('A', 'B', 'C');
```

âš ï¸ **æ³¨æ„**: æœ¬ç•ªç’°å¢ƒã§ã¯çµ¶å¯¾ã«å®Ÿè¡Œã—ãªã„ã§ãã ã•ã„ã€‚

---

## ðŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [DATABASE_RULES.md](./DATABASE_RULES.md) - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å…¨èˆ¬ã®ãƒ«ãƒ¼ãƒ«
- [DEMO_DATA_POLICY.md](./DEMO_DATA_POLICY.md) - ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ãƒãƒªã‚·ãƒ¼ï¼ˆã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®è¦ç´„ç‰ˆï¼‰

---

## ðŸ’¡ ã¾ã¨ã‚

### è¦šãˆã¦ãŠãã¹ã3ã¤ã®ãƒ«ãƒ¼ãƒ«

1. **ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã¯CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿**
2. **ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯å¤‰æ›´ã—ãªã„**
3. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¯ä¿å­˜ã—ãªã„**

ã“ã‚Œã‚‰ã‚’å®ˆã‚Œã°ã€ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†ã¯ç°¡å˜ã§å®‰å…¨ã§ã™ã€‚
